---
title: 判断完全平方数
---

# 如何实现判断一个完全平方数

在写王老师的 EduCoder 时需要实现判断完全平方数，发现若是直接暴力遍历还是挺麻烦的。

## 解法

直接求肯定是不行的，所以我们逆向求

```c
const int step=1e-6;
if((int)sqrt(n)-sqrt(x)<step||sqrt(n)-(int)sqrt(n)<step)
    return true;
```

这种思路用到`sqrt()`函数进行开方操作，这个函数头文件是`<math.h>` 因此，它的返回值是一个浮点数，那么就要判断这个浮点数是否原本是整数。

但这个操作容易产生 误判，关键在于`step`定义为某一个很小的确定的数时不一定可以作为衡量标准 。当 n 很大的时候，step 可能就不够用了，比如 n=1e12+1 时，因为`sqrt(n)=1000000.0000005`，由于 sqrt(n)与 1000000 的误差小于 1e-6,这个程序就会误认为此时 n 是一个完全平方数。总之，这个代码是有一定问题的。
解决这个问题的更好的办法是对取得的浮点数采用四舍五入的方法得到对应的整数 m，然后判断 m\*m==n 是否成立。这就是判断完全平方数的正确姿势啦！具体代码如下：

```c
int m=floor(sqrt(n)+0.5);
if(m*m==n)
    return true;
```
